# -- gÃ©nÃ©ral -------------------------------------------------------------------

# Terminal moderne avec support couleurs vraies
set -g  default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

setw -g  xterm-keys   on
set  -s  escape-time  10      # sÃ©quences de commandes plus rapides
set  -sg repeat-time  600     # augmente le dÃ©lai de rÃ©pÃ©tition
set  -s  focus-events on

set  -q -g status-utf8 on     # attendre de l'UTF-8 (tmux < 2.2)
setw -q -g utf8        on

set -g history-limit 10000    # historique plus important (recommandÃ©)

# Tuer une session/fenÃªtre/panneau plus facilement
bind x confirm-before -p "kill-pane #P? (y/n)"    kill-pane
bind X confirm-before -p "kill-window #W? (y/n)"  kill-window
bind Q confirm-before -p "kill-session #S? (y/n)" kill-session

# Changer le prÃ©fixe de 'Ctrl+B' Ã  'Ctrl+Espace'
unbind C-b
set-option -g prefix C-Space
bind-key C-Space send-prefix

# -- affichage -----------------------------------------------------------------

set  -g base-index      1     # commencer la numÃ©rotation des fenÃªtres Ã  1
setw -g pane-base-index 1     # rendre la numÃ©rotation des panneaux cohÃ©rente avec les fenÃªtres

set -g renumber-windows on    # renumÃ©roter les fenÃªtres lorsqu'une fenÃªtre est fermÃ©e

set -g status-interval     10 # rafraÃ®chir la barre d'Ã©tat toutes les 10 secondes
set -g display-panes-time 800 # durÃ©e d'affichage des indicateurs de panneaux lÃ©gÃ¨rement augmentÃ©e
set -g display-time      1000 # durÃ©e d'affichage des messages d'Ã©tat lÃ©gÃ¨rement augmentÃ©e

# effacer l'Ã©cran sans toucher Ã  l'historique
bind -n C-l send-keys C-l

# effacer l'Ã©cran ET l'historique (raccourci alternatif)
bind -n C-k send-keys C-l \; run 'sleep 0.2' \; clear-history

# activitÃ©
set -g monitor-activity on
set -g visual-activity off


# -- navigation ----------------------------------------------------------------

# crÃ©er une session
bind C-c new-session

# crÃ©er une session nommÃ©e
bind C-s command-prompt -p "Nom de la nouvelle session: " "new-session -d -s '%%'"

# lister toutes les sessions avec aide contextuelle
bind C-l choose-tree -s -O time -f '#{?session_grouped,#{session_group}: ,}#{session_name}#{?session_attached, (attached),}' -K 'x: kill-session, d: detach, Enter: attach'

# interface de gestion complÃ¨te (sessions + fenÃªtres + panneaux)
bind C-w choose-tree -Z

# navigation entre les sessions
bind    BTab switch-client -l  # aller Ã  la derniÃ¨re session
bind -r C-p  switch-client -p  # session prÃ©cÃ©dente
bind -r C-n  switch-client -n  # session suivante

# renommer la session courante
bind '$' command-prompt -I "#S" "rename-session '%%'"

# navigation entre les panneaux
bind > swap-pane -D       # Ã©changer le panneau courant avec le suivant
bind < swap-pane -U       # Ã©changer le panneau courant avec le prÃ©cÃ©dent

# IntÃ©gration NeoVim
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^S (n?vim?x?)(-wrapped)?(diff)?$'"

# rechercher dans zsh
bind-key -n C-f send-keys C-r

## Diviser la fenÃªtre courante horizontalement (garde le rÃ©pertoire)
bind-key 's' if-shell "$is_vim" "send-keys Escape ':split' Enter" 'split-window -v -c "#{pane_current_path}"'
## Diviser la fenÃªtre courante verticalement (garde le rÃ©pertoire)
bind-key 'v' if-shell "$is_vim" "send-keys Escape ':vsplit' Enter" 'split-window -h -c "#{pane_current_path}"'

## Navigation entre les panneaux
bind-key -n 'C-t' if-shell "$is_vim" 'send-keys C-t'  { if -F '#{pane_at_left}'   '' 'select-pane -L' }
bind-key -n 'C-s' if-shell "$is_vim" 'send-keys C-s'  { if -F '#{pane_at_bottom}' '' 'select-pane -D' }
bind-key -n 'C-r' if-shell "$is_vim" 'send-keys C-r'  { if -F '#{pane_at_top}'    '' 'select-pane -U' }
bind-key -n 'C-n' if-shell "$is_vim" 'send-keys C-n'  { if -F '#{pane_at_right}'  '' 'select-pane -R' }

bind-key -T copy-mode-vi 'C-t' if -F '#{pane_at_left}'   '' 'select-pane -L'
bind-key -T copy-mode-vi 'C-s' if -F '#{pane_at_bottom}' '' 'select-pane -D'
bind-key -T copy-mode-vi 'C-r' if -F '#{pane_at_top}'    '' 'select-pane -U'
bind-key -T copy-mode-vi 'C-n' if -F '#{pane_at_right}'  '' 'select-pane -R'

# maximiser le panneau courant
bind + resize-pane -Z

# redimensionnement des panneaux
bind -r T resize-pane -L 2
bind -r S resize-pane -D 2
bind -r R resize-pane -U 2
bind -r N resize-pane -R 2

# navigation entre les fenÃªtres
unbind n
unbind p
bind -r C-t previous-window # sÃ©lectionner la fenÃªtre prÃ©cÃ©dente
bind -r C-n next-window     # sÃ©lectionner la fenÃªtre suivante
bind    Tab last-window     # aller Ã  la derniÃ¨re fenÃªtre active

# AccÃ¨s rapide aux fenÃªtres par numÃ©ro
bind -r 1 select-window -t 1
bind -r 2 select-window -t 2
bind -r 3 select-window -t 3
bind -r 4 select-window -t 4
bind -r 5 select-window -t 5
bind -r 6 select-window -t 6
bind -r 7 select-window -t 7
bind -r 8 select-window -t 8
bind -r 9 select-window -t 9

# CrÃ©er une nouvelle fenÃªtre dans le rÃ©pertoire courant
bind c new-window     -c "#{pane_current_path}"
bind C command-prompt -p "Name of new window:" "new-window -n '%%' -c '#{pane_current_path}'"

# Renommer la fenÃªtre courante
bind , command-prompt -I "#W" "rename-window '%%'"

# DÃ©sactiver le renommage automatique pour une fenÃªtre spÃ©cifique
bind M setw automatic-rename off \; command-prompt -I "#W" "rename-window '%%'"

# activer/dÃ©sactiver la souris
bind m run "cut -c3- '#{TMUX_CONF}' | sh -s _toggle_mouse"

# -- souris et ergonomie ------------------------------------------------------

# Support souris moderne
set -g mouse on

# DÃ©filement plus fluide
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# -- mode copie ---------------------------------------------------------------

setw -g mode-keys vi
bind Enter copy-mode # entrer en mode copie

# Raccourcis personnalisÃ©s pour le mode copie (style vi)
bind -T copy-mode-vi v      send -X begin-selection           # 'v' : commencer la sÃ©lection (mode visuel)
bind -T copy-mode-vi C-v    send -X rectangle-toggle          # 'Ctrl+v' : basculer en sÃ©lection rectangulaire
bind -T copy-mode-vi y      send -X copy-selection-and-cancel # 'y' : copier la sÃ©lection et quitter le mode copie
bind -T copy-mode-vi Escape send -X cancel                    # 'Ã‰chap' : annuler la sÃ©lection et quitter le mode copie
bind -T copy-mode-vi T      send -X start-of-line             # 'T' : aller au dÃ©but de la ligne
bind -T copy-mode-vi N      send -X end-of-line               # 'N' : aller Ã  la fin de la ligne
bind -T copy-mode-vi /      send -X search-forward            # '/' : recherche vers l'avant
bind -T copy-mode-vi ?      send -X search-backward           # '?' : recherche vers l'arriÃ¨re

# copier vers le presse-papier systÃ¨me (Wayland et X11)
if -b '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' \
  'bind y run -b "tmux save-buffer - | wl-copy"'

if -b '[ "$XDG_SESSION_TYPE" = "x11" ] && command -v xclip > /dev/null 2>&1' \
  'bind y run -b "tmux save-buffer - | xclip -selection clipboard"'

# -- tampons ------------------------------------------------------------------

#bind b list-buffers     # lister les tampons de collage
#bind p paste-buffer -p  # coller depuis le tampon de tÃªte
#bind P choose-buffer    # choisir le tampon Ã  coller

# -- aide ----------------------------------------------------------------------

# Afficher l'aide pour la gestion des sessions
tmux_help='echo -n "
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¯â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Session                            â”‚ Fenetre                            â”ƒ
â”ƒ   Leader + C-c : Nouvelle          â”‚   Leader + c : Nouvelle            â”ƒ
â”ƒ   Leader + C-s : Nouvelle nommÃ©e   â”‚   Leader + C : Nouvelle NommÃ©e     â”ƒ
â”ƒ   Leader + \$   : Renommer courante â”‚   Leader + , : Renommer courante   â”ƒ
â”ƒ   Leader + Q   : Tuer courante     â”‚   Leader + X : Tuer courante       â”ƒ
â” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¨
â”ƒ Panneau                            â”‚ Autre                              â”ƒ
â”ƒ   C-t : To left                    â”‚   C-l : Clear Panneau              â”ƒ
â”ƒ   C-s : To Botom                   â”‚   C-k : clear + delete historique  â”ƒ
â”ƒ   C-r : To Top                     â”‚   C-f : Recherche zsh              â”ƒ
â”ƒ   C-n : To Right                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¨
â”ƒ   Leader + < : Ã‰changer suivant    â”‚ Dans Choose-Tree (Leader + w)      â”ƒ
â”ƒ   Leader + > : Ã‰changer prÃ©cÃ©dent  â”‚   Enter      : Attacher la session â”ƒ
â”ƒ   Leader + + : Maximiser           â”‚   x          : Tuer la session     â”ƒ
â”ƒ                                    â”‚   q / Escape : Quitter sans action â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”·â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›"; read'

bind h display-popup -E -w 77 -h 21 "$tmux_help"

# -- menu contextuel souris avancÃ© --------------------------------------------

# Menu contextuel au clic droit (MouseDown3Pane) avec options intelligentes :
# - DÃ©tecte automatiquement le contexte (mode copie, mot/ligne/lien sous la souris, vim)
# - Propose des actions contextuelles adaptÃ©es selon la situation
# - Inclut la gestion des panneaux, division, Ã©change et zoom
# - Options spÃ©ciales vim quand nvim/vim est dÃ©tectÃ©
# - Menus Ã  deux niveaux pour une meilleure organisation
# 
# Actions disponibles dans le menu :
# - Navigation : Go To Top/Bottom (si en mode copie)
# - Recherche : Search For [mot] (Ctrl+r)
# - Texte : Type/Copy mot sous la souris (Ctrl+y/c)
# - Ligne : Copy Line (l)
# - Liens : Type/Copy hyperlink (Ctrl+h/h)
# - Vim (si dÃ©tectÃ©) : Save/Quit/Split Horizontal/Split Vertical
# - Division : Horizontal/Vertical Split (h/v)
# - Ã‰change : Swap Up/Down/Marked (u/d/s)
# - Gestion : Kill/Respawn/Mark/Zoom (X/R/m/z)

# -- Menus modulaires avec plugin shell ---------------------------------------

# Menu principal accessible via Ctrl+E
bind-key -n 'C-e' run-shell '$tmux_menu show_main'

# Menu principal Ã©galement accessible via double-clic gauche sur la barre de statut
bind-key -T root DoubleClick1Status run-shell '$tmux_menu show_main'

# Menu principal accessible via clic du milieu sur un panneau
bind-key -T root MouseDown2Pane run-shell '$tmux_menu show_main'

# Raccourcis directs vers les sous-menus
bind-key -n 'M-s' run-shell '$tmux_menu show_sessions'
bind-key -n 'M-w' run-shell '$tmux_menu show_windows'
bind-key -n 'M-p' run-shell '$tmux_menu show_panes'
bind-key -n 'M-t' run-shell '$tmux_menu show_tools'

bind-key -T root MouseDown3Pane if-shell -F -t = "#{&&:#{pane_in_mode},#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}}" { select-pane -t = } \
{ \
  if-shell "$is_vim" \
  { \
    display-menu -T "#[align=centre,bg=#{@thm_surface_0},fg=#{@thm_lavender}] ó°¹¯ #{pane_index} (#{pane_current_command}) " -t = -x M -y M \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},#[fg=#{@thm_blue}]â¬†ï¸ Go To Top,}" < { send-keys -X history-top } \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},#[fg=#{@thm_blue}]â¬‡ï¸ Go To Bottom,}" > { send-keys -X history-bottom } \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#{?mouse_word,#[fg=#{@thm_peach}]ğŸ” Search For #[underscore]#{=/9/...:mouse_word},}" C-r { if-shell -F "#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}" "copy-mode -t=" ; send-keys -X -t = search-backward "#{q:mouse_word}" } \
      "#{?mouse_word,#[fg=#{@thm_yellow}]ğŸ“ Type #[underscore]#{=/9/...:mouse_word},}" C-y { copy-mode -q ; send-keys -l "#{q:mouse_word}" } \
      "#{?mouse_word,#[fg=#{@thm_green}]ğŸ“ Copy #[underscore]#{=/9/...:mouse_word},}" c { copy-mode -q ; set-buffer "#{q:mouse_word}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_word,#[fg=#{@thm_sapphire}]ğŸ“ Copy Line,}" l { copy-mode -q ; set-buffer "#{q:mouse_line}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_word,-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#{?mouse_hyperlink,#[fg=#{@thm_pink}]ğŸ“ Type #[underscore]#{=/9/...:mouse_hyperlink},}" C-h { copy-mode -q ; send-keys -l "#{q:mouse_hyperlink}" } \
      "#{?mouse_hyperlink,#[fg=#{@thm_pink}]ğŸ“ Copy #[underscore]#{=/9/...:mouse_hyperlink},}" h { copy-mode -q ; set-buffer "#{q:mouse_hyperlink}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_hyperlink,-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#[fg=#{@thm_green}]ğŸ’¾ Vim: Save" w { send-keys Escape ':w' Enter } \
      "#[fg=#{@thm_blue}]ğŸ’¾ Vim: Save & Quit" q { send-keys Escape ':wq' Enter } \
      "#[fg=#{@thm_red}]ğŸšª Vim: Quit" Q { send-keys Escape ':q!' Enter } \
      "#[fg=#{@thm_mauve}]ó°¤¼ Vim: Split Horizontal" H { send-keys Escape ':split' Enter } \
      "#[fg=#{@thm_mauve}]ó°¤» Vim: Split Vertical" V { send-keys Escape ':vsplit' Enter } \
      "#[fg=#{@thm_yellow}]â• Vim: New Tab" t { send-keys Escape ':tabnew' Enter } \
      "-#[align=centre,fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
      "#[fg=#{@thm_teal}]ó°¤¼ Tmux Split Horizontal" h { split-window -h } \
      "#[fg=#{@thm_teal}]ó°¤» Tmux Split Vertical" v { split-window -v } \
      "-#[align=centre,fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
      "#{?#{>:#{window_panes},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Up,}" u { swap-pane -U } \
      "#{?#{>:#{window_panes},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Down,}" d { swap-pane -D } \
      "#{?pane_marked_set,#[fg=#{@thm_peach}]ğŸ“Œ Swap Marked,}" s { swap-pane } \
      "#{?#{>:#{window_panes},1},-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#[fg=#{@thm_red}]âŒ Kill" X { kill-pane } \
      "#[fg=#{@thm_yellow}]ğŸ”„ Respawn" R { respawn-pane -k } \
      "#{?pane_marked,#[fg=#{@thm_maroon}]ğŸ“Œ Unmark,#[fg=#{@thm_peach}]ğŸ“Œ Mark}" m { select-pane -m } \
      "#{?#{>:#{window_panes},1},#{?window_zoomed_flag,#[fg=#{@thm_blue}]ğŸ” Unzoom,#[fg=#{@thm_blue}]ğŸ” Zoom},}" z { resize-pane -Z } \
  } \
  { \
    display-menu -T "#[align=centre,bg=#{@thm_surface_0},fg=#{@thm_lavender}] ó°¹¯ #{pane_index} (#{pane_current_command}) " -t = -x M -y M \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},#[fg=#{@thm_blue}]â¬†ï¸ Go To Top,}" < { send-keys -X history-top } \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},#[fg=#{@thm_blue}]â¬‡ï¸ Go To Bottom,}" > { send-keys -X history-bottom } \
      "#{?#{m/r:(copy|view)-mode,#{pane_mode}},-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#{?mouse_word,#[fg=#{@thm_peach}]ğŸ” Search For #[underscore]#{=/9/...:mouse_word},}" C-r { if-shell -F "#{?#{m/r:(copy|view)-mode,#{pane_mode}},0,1}" "copy-mode -t=" ; send-keys -X -t = search-backward "#{q:mouse_word}" } \
      "#{?mouse_word,#[fg=#{@thm_yellow}]ğŸ“ Type #[underscore]#{=/9/...:mouse_word},}" C-y { copy-mode -q ; send-keys -l "#{q:mouse_word}" } \
      "#{?mouse_word,#[fg=#{@thm_green}]ğŸ“ Copy #[underscore]#{=/9/...:mouse_word},}" c { copy-mode -q ; set-buffer "#{q:mouse_word}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_word,#[fg=#{@thm_sapphire}]ğŸ“ Copy Line,}" l { copy-mode -q ; set-buffer "#{q:mouse_line}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_word,-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#{?mouse_hyperlink,#[fg=#{@thm_pink}]ğŸ“ Type #[underscore]#{=/9/...:mouse_hyperlink},}" C-h { copy-mode -q ; send-keys -l "#{q:mouse_hyperlink}" } \
      "#{?mouse_hyperlink,#[fg=#{@thm_pink}]ğŸ“ Copy #[underscore]#{=/9/...:mouse_hyperlink},}" h { copy-mode -q ; set-buffer "#{q:mouse_hyperlink}" ; if-shell '[ "$XDG_SESSION_TYPE" = "wayland" ] && command -v wl-copy > /dev/null 2>&1' 'run-shell "tmux save-buffer - | wl-copy"' 'if-shell "command -v xclip > /dev/null 2>&1" "run-shell \"tmux save-buffer - | xclip -selection clipboard\""' } \
      "#{?mouse_hyperlink,-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#[fg=#{@thm_teal}]ó°¤¼ Tmux Split Horizontal" h { split-window -h } \
      "#[fg=#{@thm_teal}]ó°¤» Tmux Split Vertical" v { split-window -v } \
      "-#[align=centre,fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
      "#{?#{>:#{window_panes},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Up,}" u { swap-pane -U } \
      "#{?#{>:#{window_panes},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Down,}" d { swap-pane -D } \
      "#{?pane_marked_set,#[fg=#{@thm_peach}]ğŸ“Œ Swap Marked,}" s { swap-pane } \
      "#{?#{>:#{window_panes},1},-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
      "#[fg=#{@thm_red}]âŒ Kill" X { kill-pane } \
      "#[fg=#{@thm_yellow}]ğŸ”„ Respawn" R { respawn-pane -k } \
      "#{?pane_marked,#[fg=#{@thm_maroon}]ğŸ“Œ Unmark,#[fg=#{@thm_peach}]ğŸ“Œ Mark}" m { select-pane -m } \
      "#{?#{>:#{window_panes},1},#{?window_zoomed_flag,#[fg=#{@thm_blue}]ğŸ” Unzoom,#[fg=#{@thm_blue}]ğŸ” Zoom},}" z { resize-pane -Z } \
  } \
}


bind-key -T root MouseDown3Status \
  display-menu -T "#[align=centre,bg=#{@thm_surface_0},fg=#{@thm_lavender}] ó°¹¯ #{window_index}:#{window_name} " -t = -x W -y W \
    "#{?#{>:#{session_windows},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Left,}"  l { swap-window -t :-1 } \
    "#{?#{>:#{session_windows},1},#[fg=#{@thm_sapphire}]ğŸ”„ Swap Right,}" r { swap-window -t :+1 } \
    "#{?pane_marked_set,#[fg=#{@thm_peach}]ğŸ“Œ Swap Marked,}"             s { swap-window } \
    "#{?#{>:#{session_windows},1},-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€,}" "" "" \
    "#[fg=#{@thm_red}]âŒ Kill" X { kill-window } \
    "#[fg=#{@thm_yellow}]ğŸ”„ Respawn" R { respawn-window -k } \
    "#{?pane_marked,#[fg=#{@thm_maroon}]ğŸ“Œ Unmark,#[fg=#{@thm_peach}]ğŸ“Œ Mark}" m { select-pane -m } \
    "#[fg=#{@thm_green}]ğŸ“ Rename" n { command-prompt -F -I "#W" { rename-window -t "#{window_id}" "%%" } } \
    "-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
    "#[fg=#{@thm_pink}]â• New After"  w { new-window -a } \
    "#[fg=#{@thm_pink}]â• New At End" W { new-window }


bind-key -T root \
  MouseDown3StatusLeft   \
    display-menu -T "#[align=centre,bg=#{@thm_surface_0},fg=#{@thm_lavender}] ó°¹¯ #{session_name} " -t = -x M -y W \
      "#[fg=#{@thm_blue}]â­ï¸ Next"        n { switch-client -n } \
      "#[fg=#{@thm_blue}]â®ï¸ Previous"    p { switch-client -p } \
      "-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
      "#[fg=#{@thm_yellow}]ğŸ”¢ Renumber"  N { move-window -r } \
      "#[fg=#{@thm_green}]ğŸ“ Rename"     n { command-prompt -I "#S" { rename-session "%%" } } \
      "-#[align=centre fg=#{@thm_lavender}]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" "" "" \
      "#[fg=#{@thm_pink}]â• New Session" s { new-session } \
      "#[fg=#{@thm_pink}]â• New Window"  w { new-window }

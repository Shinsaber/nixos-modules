#!/usr/bin/env bash

# Script d'aide pour basculer vers Java 7
# Utilisation: source java7-env.sh

# Sauvegarde les variables Java actuelles
if [ ! -z "${JAVA_HOME:-}" ]; then
    export JAVA_HOME_BACKUP="$JAVA_HOME"
fi
if [ ! -z "${JDK_HOME:-}" ]; then
    export JDK_HOME_BACKUP="$JDK_HOME"
fi

# Configure Java 7
export JAVA_HOME="@openjdk7@"
export JDK_HOME="@openjdk7@"
export PATH="@openjdk7@/bin:$PATH"

echo "üîÑ Environnement Java 7 configur√©"
echo "üìç JAVA_HOME: $JAVA_HOME"
echo "‚ö†Ô∏è  ATTENTION: Java 7 est obsol√®te et contient des vuln√©rabilit√©s"
echo "üìù Version Java:"
java -version

# Fonction pour restaurer l'environnement Java pr√©c√©dent
restore_java() {
    if [ ! -z "${JAVA_HOME_BACKUP:-}" ]; then
        export JAVA_HOME="$JAVA_HOME_BACKUP"
        unset JAVA_HOME_BACKUP
    else
        unset JAVA_HOME
    fi
    
    if [ ! -z "${JDK_HOME_BACKUP:-}" ]; then
        export JDK_HOME="$JDK_HOME_BACKUP"
        unset JDK_HOME_BACKUP
    else
        unset JDK_HOME
    fi
    
    # Nettoie le PATH (approximatif)
    export PATH=$(echo "$PATH" | sed "s|@openjdk7@/bin:||g")
    
    echo "‚ôªÔ∏è  Environnement Java restaur√©"
}

echo "üí° Utilisez 'restore_java' pour revenir √† la configuration Java pr√©c√©dente"
